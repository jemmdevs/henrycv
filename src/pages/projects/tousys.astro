---
import Layout from "../../layouts/Layout.astro";
import Navbar from "../../components/Navbar.astro";
import Footer from "../../components/Footer.astro";
import ProjectHero from "../../components/project/ProjectHero.astro";
import ProjectTitle from "../../components/project/ProjectTitle.astro";
import ProjectBody from "../../components/project/ProjectBody.astro";
import ProjectDetails from "../../components/project/ProjectDetails.astro";
import LinkCard from "../../components/project/LinkCard.astro";
import ProjectMedia from "../../components/project/ProjectMedia.astro";
import Divider from "../../components/project/Divider.astro";
import Spacer from "../../components/project/Spacer.astro";
---

<Layout title="Tousys - José Enrique">
    <!-- Contenido Principal - z-index ALTO + background sólido -->
    <div class="relative z-[200] bg-background">
        <div class="bg-background pb-8">
            <Navbar showClose={true} />
            <div style="padding-top: 20px;">
                <!-- Main Container -->
                <main class="min-h-[70vh]">
                    <!-- Grid Container -->
                    <div class="px-3 pt-0 pb-6 max-w-[1800px] mx-auto">
                        <div class="grid grid-cols-12 gap-3">
                            <!-- Hero -->
                            <ProjectHero
                                content="/images/tousysBig.avif"
                                objectFit="cover"
                            />

                            <!-- Título sticky (izquierda) -->
                            <ProjectTitle role="Research and Development">
                                Tousys
                            </ProjectTitle>

                            <!-- Descripción (derecha) -->
                            <ProjectBody col={2}>
                                <p class="mb-4">
                                    I led the design and development of Alawal,
                                    a DNA sequence optimization platform. I
                                    established the modular architecture and
                                    component system to ensure high scalability
                                    for complex, data-intensive scientific
                                    workflows.
                                </p>
                                <p>
                                    I owned the implementation of client-side
                                    logic and API contracts, translating
                                    technical requirements into a
                                    production-ready and high-performance web
                                    interface.
                                </p>
                            </ProjectBody>

                            <!-- Detalles -->
                            <ProjectDetails
                                role="Full Stack Developer"
                                collaborators={[
                                    "Raúl Vazquez Verde",
                                    "Jesús Mateus López",
                                ]}
                                duration="2025 - Present"
                                tools={["React", "Next.js"]}
                            />

                            <!-- Links -->
                            <LinkCard col={1} href="#"> tousys.com </LinkCard>

                            <!-- Divisor -->
                            <Divider />

                            <!-- Sección 1 -->
                            <ProjectBody title="Overview" col={1}>
                                Description of the project.
                            </ProjectBody>

                            <!-- Note: Using video placeholder or image if available. For now using Hero video or reusing placeholder -->
                            <ProjectMedia
                                src="/images/tousys.webm"
                                isVideo={true}
                            >
                                Project placeholder video
                            </ProjectMedia>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <Footer />
</Layout>

<script>
    // Intersection Observer to pause/play video in Hero to optimize performance
    const videoObserver = new IntersectionObserver(
        (entries) => {
            entries.forEach((entry) => {
                const video = entry.target as HTMLVideoElement;

                if (entry.isIntersecting) {
                    video.play().catch(() => {});
                } else {
                    video.pause();
                }
            });
        },
        { threshold: 0.1 },
    );

    document.querySelectorAll("video").forEach((video) => {
        videoObserver.observe(video);
    });
</script>
